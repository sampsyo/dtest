#!/usr/bin/env python

import sys
import struct


def unpack_advance(fmt, buffer, offset):
    """Unpack a string from a buffer. Return the unpacked values and the
    new offset.
    """
    res = struct.unpack_from(fmt, buffer, offset)
    return res, offset + struct.calcsize(fmt)


def parse_packed_floats(buffer):
    """Parse the data format generated by `distgen` for this
    application.
    """
    offset = 0
    rows = []
    while offset < len(buffer):
        (length,), offset = unpack_advance('i', buffer, offset)
        row, offset = unpack_advance('%sf' % length, buffer, offset)
        rows.append(row)
    return rows


def disttest(infile):
    rows = parse_packed_floats(infile.read())
    print(rows)


if __name__ == '__main__':
    disttest(sys.stdin)
